<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <!-- ëª¨ë°”ì¼ ëŒ€ì‘ -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ë‹¤ë¦¬ê²Œì„ ì• ë‹ˆë©”ì´ì…˜</title>

  <!-- ì¹´í†¡ ë§í¬ ì¸ë„¤ì¼ìš© OG íƒœê·¸ -->
  <meta property="og:title" content="ì‚¬ë‹¤ë¦¬ê²Œì„">
  <meta property="og:description" content="ì „ì²´ ê²°ê³¼ í™•ì¸í•˜ê¸°">
  <meta property="og:image" content="https://raw.githubusercontent.com/Devil-Destroyer/ladder/main/ladder_thumbnail.png">
  <meta property="og:url" content="https://devil-destroyer.github.io/ladder/">

  <style>
    body { margin:0; padding:1rem; font-family:sans-serif; background:#fafafa; text-align:center; }
    h1 { margin-bottom:1rem; }
    button { margin-bottom:1rem; padding:.5rem 1rem; font-size:1rem; }
    #canvas-wrap { overflow-x:auto; }
    canvas { background:#fff; display:block; margin:0 auto; }
    #results { margin-top:1rem; list-style:none; padding:0; text-align:left; display:inline-block; }
    #results li { margin:.5rem 0; }
    .punishment { color:#e74c3c; font-weight:bold; }
    .winner     { color:#27ae60; font-weight:bold; }
  </style>
</head>
<body>
  <h1>ğŸ¯ ì‚¬ë‹¤ë¦¬ê²Œì„</h1>
  <button id="startBtn">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
  <div id="canvas-wrap">
    <canvas id="ladder"></canvas>
  </div>
  <ul id="results"></ul>

  <script>
    // 1) ì°¸ê°€ì + ìŒë£Œ + í”„ë¡œí•„ ì´ë¯¸ì§€ íŒŒì¼ëª… + ìƒ‰
    const participants = [
      {name:"Jinsoo",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"Jinsoo.png",          color:"#3498db"},
      {name:"ì„¸ë¯¸",          drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",        image:"semi.png",           color:"#9b59b6"},
      {name:"êµ¬ìê±´",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"guagain.png",        color:"#e67e22"},
      {name:"ê¹€ë§Œì„±",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"kimmanseong.png",     color:"#1abc9c"},
      {name:"ê¹€ì„¸ë´‰",        drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",        image:"kimsebung.png",      color:"#f1c40f"},
      {name:"ê¹€ì² ë™",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"kimcheoldong.png",    color:"#e84393"},
      {name:"ê¹€íƒœí˜¸",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"kimtaeho.png",       color:"#00cec9"},
      {name:"ì‹ ìœ ì„ ",        drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",        image:"sinyuseon.png",      color:"#0984e3"},
      {name:"ê°€ë³´ìê³ ~~",   drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"gaboja.png",         color:"#d63031"},
      {name:"ì—„ê¸°ì¢…",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"eomgijong.png",      color:"#6c5ce7"},
      {name:"ì´ì¬ìŠ¹",        drink:"ì•„ìƒ·ì¶” 2ì” !!!", image:"leejaeseung.png",    color:"#00b894"},
      {name:"ì „ë•ì„±(ë² ë“œë¡œ)",drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",         image:"jeondeokseong.png",  color:"#fdcb6e"}
    ];
    // 2) ë²Œì¹™ì ê³ ì •
    const punishment = {name:"ì„ìƒí˜", drink:"ì¶•~ë‹¹ì²¨: ë”¸ê¸°ìš”ê±°íŠ¸ìƒ·ì¶”ê°€", image:"imsanghyuk.png", color:"#e74c3c"};

    const all = [punishment, ...participants];
    const cols = all.length, rows = 12;

    // ë ˆì´ì•„ì›ƒ ìƒìˆ˜
    const marginX = 50, marginY = 20;
    const imgH = 40, nameH = 20;
    const colW = 100, rowH = 30;
    const cw = marginX*2 + colW*(cols-1);
    const ch = marginY*2 + imgH + nameH + rowH*rows;

    // ìº”ë²„ìŠ¤ ì„¸íŒ…
    const canvas = document.getElementById('ladder');
    canvas.width = cw;
    canvas.height = ch;
    const ctx = canvas.getContext('2d');

    // ì‚¬ë‹¤ë¦¬ ê°€ë¡œì¤„ ëœë¤ ìƒì„±
    const rungs = Array.from({length: rows}, () =>
      Array.from({length: cols - 1}, () => Math.random() < 0.4)
    );

    // 3) í”„ë¡œí•„ ì´ë¯¸ì§€ ë¡œë“œ (ë£¨íŠ¸ í´ë” ê¸°ì¤€)
    const baseUrl = 'https://raw.githubusercontent.com/Devil-Destroyer/ladder/main/';
    const images = all.map(p => {
      const img = new Image();
      img.src = baseUrl + encodeURIComponent(p.image);
      img.onload = drawLadder;
      img.onerror = drawLadder;
      return img;
    });

    // 4) ì‚¬ë‹¤ë¦¬íŒ + í”„ë¡œí•„ + ì´ë¦„ + ê¸°ë³¸ íšŒìƒ‰ì„  + ê°€ë¡œë§‰ëŒ€ ê·¸ë¦¬ê¸°
    function drawLadder() {
      ctx.clearRect(0, 0, cw, ch);
      ctx.font = "14px sans-serif";

      // í”„ë¡œí•„ & ì´ë¦„
      all.forEach((p, i) => {
        const x = marginX + i * colW;
        // ì´ë¯¸ì§€
        if (images[i].complete && images[i].naturalWidth > 0) {
          ctx.drawImage(images[i], x - 20, marginY, 40, imgH);
        } else {
          ctx.fillStyle = "#ccc";
          ctx.fillRect(x - 20, marginY, 40, imgH);
        }
        // ì´ë¦„
        ctx.fillStyle = "#333";
        ctx.textAlign = "center";
        ctx.fillText(p.name, x, marginY + imgH + nameH - 4);
      });

      // ê¸°ë³¸ ì„¸ë¡œì„ 
      ctx.strokeStyle = "#ccc";
      ctx.lineWidth = 2;
      for (let i = 0; i < cols; i++) {
        const x = marginX + i * colW;
        ctx.beginPath();
        ctx.moveTo(x, marginY + imgH + nameH);
        ctx.lineTo(x, marginY + imgH + nameH + rowH * rows);
        ctx.stroke();
      }

      // ê°€ë¡œë§‰ëŒ€
      for (let y = 0; y < rows; y++) {
        for (let x = 0; x < cols - 1; x++) {
          if (rungs[y][x]) {
            const x1 = marginX + x * colW;
            const y1 = marginY + imgH + nameH + y * rowH;
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x1 + colW, y1);
            ctx.stroke();
          }
        }
      }
    }

    // 5) ê²½ë¡œ ê³„ì‚° (90Â° ì§€ê·¸ì¬ê·¸)
    function computePaths() {
      return all.map((_, idx) => {
        let cx = idx, cy = 0;
        const path = [{x: cx, y: cy}];
        for (let y = 0; y < rows; y++) {
          if (rungs[y][cx]) {
            cx++;
            path.push({x: cx, y: y});
          } else if (cx > 0 && rungs[y][cx - 1]) {
            cx--;
            path.push({x: cx, y: y});
          }
          path.push({x: cx, y: y + 1});
        }
        return path;
      });
    }

    // 6) ì• ë‹ˆë©”ì´ì…˜: í•œ ì‚¬ëŒì”© ì°¨ë¡€ëŒ€ë¡œ
    function animate() {
      drawLadder();
      const paths = computePaths();
      let i = 0;

      function drawOne() {
        const path = paths[i];
        let step = 0;
        ctx.lineWidth = 4;
        ctx.strokeStyle = all[i].color;

        const timer = setInterval(() => {
          if (step > 0) {
            const p0 = path[step - 1], p1 = path[step];
            const x0 = marginX + p0.x * colW;
            const y0 = marginY + imgH + nameH + p0.y * rowH;
            const x1 = marginX + p1.x * colW;
            const y1 = marginY + imgH + nameH + p1.y * rowH;
            ctx.beginPath();
            ctx.moveTo(x0, y0);
            ctx.lineTo(x1, y1);
            ctx.stroke();
          }
          step++;
          if (step >= path.length) {
            clearInterval(timer);
            i++;
            if (i < paths.length) {
              setTimeout(drawOne, 200);
            } else {
              showResults();
            }
          }
        }, 100);
      }

      drawOne();
    }

    // 7) ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸
    function showResults() {
      const ul = document.getElementById('results');
      ul.innerHTML = '';

      // ë²Œì¹™ì
      const li0 = document.createElement('li');
      li0.className = 'punishment';
      li0.textContent = `ğŸ´ ${punishment.name} â†’ ${punishment.drink}`;
      ul.appendChild(li0);

      // ìƒ· ë‹¹ì²¨ì
      const winner = participants.find(p => p.drink.includes('ìƒ·'));
      const li1 = document.createElement('li');
      li1.className = 'winner';
      li1.textContent = `ğŸ‰ ${winner.name} â†’ ${winner.drink}`;
      ul.appendChild(li1);

      // ë‚˜ë¨¸ì§€
      participants.forEach(p => {
        if (p !== winner) {
          const li = document.createElement('li');
          li.textContent = `${p.name} â†’ ${p.drink}`;
          ul.appendChild(li);
        }
      });
    }

    document.getElementById('startBtn').addEventListener('click', animate);
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸íŒ ê·¸ë¦¬ê¸°
    drawLadder();
  </script>
</body>
</html>

