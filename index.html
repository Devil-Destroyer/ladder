<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ë‹¤ë¦¬ê²Œì„ ì• ë‹ˆë©”ì´ì…˜ + ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸</title>

  <!-- ì¹´í†¡ ë§í¬ ì¸ë„¤ì¼ìš© OG íƒœê·¸ -->
  <meta property="og:title" content="ì‚¬ë‹¤ë¦¬ê²Œì„" />
  <meta property="og:description" content="ì „ì²´ ê²°ê³¼ í™•ì¸í•˜ê¸°" />
  <meta property="og:image" content="https://raw.githubusercontent.com/Devil-Destroyer/ladder/main/ladder_thumbnail.png" />
  <meta property="og:url" content="https://devil-destroyer.github.io/ladder/" />

  <style>
    body {
      margin: 0;
      padding: 1rem;
      font-family: sans-serif;
      background: #fafafa;
      text-align: center;
    }
    canvas {
      background: #fff;
      border: 1px solid #ddd;
      margin-bottom: 1rem;
    }
    #results {
      font-size: 1.2rem;
      line-height: 1.6;
    }
    #results ul {
      list-style: none;
      padding: 0;
    }
    #results li {
      margin: 0.5rem 0;
    }
    .punishment { color: #e74c3c; font-weight: bold; }
    .winner     { color: #27ae60; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ğŸ¯ ì‚¬ë‹¤ë¦¬ ê²Œì„</h1>
  <canvas id="ladder" width="360" height="500"></canvas>
  <div id="results"></div>

  <script>
    // 1) ì°¸ê°€ì + ìŒë£Œ + ì»¬ëŸ¬
    const participants = [
      {name:"Jinsoo",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#3498db"},
      {name:"ì„¸ë¯¸",             drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#9b59b6"},
      {name:"êµ¬ìê±´",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#e67e22"},
      {name:"ê¹€ë§Œì„±",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#1abc9c"},
      {name:"ê¹€ì„¸ë´‰",           drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#f1c40f"},
      {name:"ê¹€ì² ë™",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#e84393"},
      {name:"ê¹€íƒœí˜¸",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#00cec9"},
      {name:"ì‹ ìœ ì„ ",           drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#0984e3"},
      {name:"ê°€ë³´ìê³ ~~",      drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#d63031"},
      {name:"ì—„ê¸°ì¢…",           drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#6c5ce7"},
      {name:"ì´ì¬ìŠ¹",           drink:"ì•„ìƒ·ì¶” 2ì” with someone...", color:"#00b894"},
      {name:"ì „ë•ì„±(ë² ë“œë¡œ)",  drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#fdcb6e"},
    ];
    // 2) ë²Œì¹™ì
    const punishment = {name:"ì„ìƒí˜", drink:"ì¶•~ë‹¹ì²¨: ë”¸ê¸°ìš”ê±°íŠ¸ìƒ·ì¶”ê°€", color:"#e74c3c"};

    const allPlayers = [punishment, ...participants];
    const cols = allPlayers.length;
    const rows = 12;
    const canvas = document.getElementById("ladder");
    const ctx = canvas.getContext("2d");
    const w = canvas.width, h = canvas.height;
    const margin = 40;
    const colW = (w - margin*2)/(cols-1);
    const rowH = (h - margin*2)/(rows);

    // 3) ëœë¤ ì‚¬ë‹¤ë¦¬ ê°€ë¡œì¤„
    const rungs = Array.from({length: rows}, () =>
      Array.from({length: cols-1}, () => Math.random() < 0.4)
    );

    function drawLadder(){
      ctx.clearRect(0,0,w,h);
      ctx.lineWidth = 2; ctx.strokeStyle = "#aaa";
      // ì„¸ë¡œì¤„
      for(let i=0; i<cols; i++){
        const x = margin + i*colW;
        ctx.beginPath(); ctx.moveTo(x, margin); ctx.lineTo(x, h-margin); ctx.stroke();
      }
      // ê°€ë¡œì¤„
      for(let y=0; y<rows; y++){
        for(let x=0; x<cols-1; x++){
          if(rungs[y][x]){
            const x1 = margin + x*colW;
            const y1 = margin + y*rowH;
            ctx.beginPath(); ctx.moveTo(x1, y1); ctx.lineTo(x1+colW, y1); ctx.stroke();
          }
        }
      }
    }

    // 4) ê²½ë¡œ ê³„ì‚°
    function computePaths(){
      return allPlayers.map((_, idx) => {
        let cx = idx, cy = 0;
        const path = [{x:cx, y:cy}];
        while(cy < rows){
          if(cx < cols-1 && rungs[cy][cx]) cx++;
          else if(cx > 0 && rungs[cy][cx-1]) cx--;
          cy++;
          path.push({x:cx, y:cy});
        }
        return path;
      });
    }

    // 5) ì• ë‹ˆë©”ì´ì…˜ + í•˜ì´ë¼ì´íŠ¸
    function animate(){
      drawLadder();
      const paths = computePaths();
      let step = 0;
      const maxStep = rows + 1;
      // ì¼ì • ê°„ê²©ìœ¼ë¡œ í”„ë ˆì„
      const interval = setInterval(() => {
        drawLadder();
        // ëª¨ë“  ì°¸ê°€ì ê·¸ë¦¬ê¸°
        paths.forEach((path, i) => {
          const pos = path[Math.min(step, maxStep)];
          const px = margin + pos.x*colW;
          const py = margin + pos.y*rowH;
          ctx.beginPath();
          ctx.fillStyle = allPlayers[i].color;
          ctx.arc(px, py, 10, 0, Math.PI*2);
          ctx.fill();
          // ì´ë¦„ ìœ„ì—
          ctx.fillStyle = "#333";
          ctx.font = "14px sans-serif";
          ctx.textAlign = "center";
          ctx.fillText(allPlayers[i].name, px, py - 16);
          // ìŒë£Œ ì•„ë˜ì—
          ctx.font = "12px sans-serif";
          ctx.fillText(allPlayers[i].drink, px, py + 24);
        });
        step++;
        if(step > maxStep){
          clearInterval(interval);
          showResults();
        }
      }, 400); // 400ms ê°„ê²©ìœ¼ë¡œ ì†ë„ ì¡°ì ˆ
    }

    // 6) ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸
    function showResults(){
      const resultsDiv = document.getElementById("results");
      const winner = participants.find(p => p.drink.includes("ìƒ·"));
      resultsDiv.innerHTML = `
        <h2>ê²°ê³¼</h2>
        <ul>
          <li class="punishment">ğŸ´ ${punishment.name} â†’ ${punishment.drink}</li>
          <li class="winner">ğŸ‰ ${winner.name} â†’ ${winner.drink}</li>
        </ul>
      `;
    }

    // ì´ˆê¸° í‘œì‹œ
    drawLadder();
    // ìë™ ì‹œì‘ í˜¹ì€ í´ë¦­ìœ¼ë¡œ ì‹œì‘
    setTimeout(animate, 500);
  </script>
</body>
</html>
