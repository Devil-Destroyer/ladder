<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ë‹¤ë¦¬ê²Œì„ ì• ë‹ˆë©”ì´ì…˜</title>
  <style>
    body { margin:0; padding:1rem; font-family:sans-serif; background:#fafafa; }
    h1 { text-align:center; margin-bottom:1rem; }
    #canvas-wrap { overflow-x:auto; }
    canvas { background:#fff; display:block; margin:0 auto; }
    #results { margin-top:1rem; font-size:1rem; }
    #results li { margin:0.5rem 0; }
    .punishment { color:#e74c3c; font-weight:bold; }
    .winner     { color:#27ae60; font-weight:bold; }
    button { display:block; margin:0 auto 1rem; padding:0.5rem 1rem; font-size:1rem; }
  </style>
</head>
<body>
  <h1>ğŸ¯ ì‚¬ë‹¤ë¦¬ê²Œì„</h1>
  <button id="startBtn">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
  <div id="canvas-wrap">
    <canvas id="ladder" width="800" height="500"></canvas>
  </div>
  <ul id="results"></ul>

  <script>
  // 1) ì°¸ê°€ì & ìŒë£Œ & ìƒ‰
  const participants = [
    {name:"Jinsoo", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#3498db"},
    {name:"ì„¸ë¯¸",   drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#9b59b6"},
    {name:"êµ¬ìê±´", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#e67e22"},
    {name:"ê¹€ë§Œì„±", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#1abc9c"},
    {name:"ê¹€ì„¸ë´‰", drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#f1c40f"},
    {name:"ê¹€ì² ë™", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#e84393"},
    {name:"ê¹€íƒœí˜¸", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#00cec9"},
    {name:"ì‹ ìœ ì„ ", drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!", color:"#0984e3"},
    {name:"ê°€ë³´ìê³ ~~", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#d63031"},
    {name:"ì—„ê¸°ì¢…", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#6c5ce7"},
    {name:"ì´ì¬ìŠ¹", drink:"ì•„ìƒ·ì¶” 2ì” with someone...", color:"#00b894"},
    {name:"ì „ë•ì„±(ë² ë“œë¡œ)", drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸", color:"#fdcb6e"}
  ];
  const punishment = {name:"ì„ìƒí˜", drink:"ì¶•~ë‹¹ì²¨: ë”¸ê¸°ìš”ê±°íŠ¸ìƒ·ì¶”ê°€", color:"#e74c3c"};
  const all = [punishment, ...participants];

  const canvas = document.getElementById('ladder');
  const ctx = canvas.getContext('2d');
  const cols = all.length;
  const rows = 12;
  const margin = 50;
  const cw = canvas.width;
  const ch = canvas.height;
  const colW = (cw - margin*2) / (cols-1);
  const rowH = (ch - margin*2) / rows;

  // 2) ëœë¤ ì‚¬ë‹¤ë¦¬ ê°€ë¡œì¤„
  const rungs = Array.from({length:rows}, () =>
    Array.from({length:cols-1}, () => Math.random()<0.4)
  );

  function drawLadder(){
    ctx.clearRect(0,0,cw,ch);
    ctx.strokeStyle='#999'; ctx.lineWidth=2;
    // ì„¸ë¡œì¤„
    for(let i=0;i<cols;i++){
      const x = margin + i*colW;
      ctx.beginPath(); ctx.moveTo(x,margin); ctx.lineTo(x,ch-margin); ctx.stroke();
      // ì´ë¦„ ê·¸ë¦¬ê¸°
      ctx.fillStyle = all[i].color;
      ctx.textAlign='center'; ctx.font='14px sans-serif';
      ctx.fillText(all[i].name, x, margin - 20);
    }
    // ê°€ë¡œì¤„
    for(let y=0;y<rows;y++){
      for(let x=0;x<cols-1;x++){
        if(rungs[y][x]){
          const x1=margin + x*colW;
          const y1=margin + y*rowH;
          ctx.beginPath(); ctx.moveTo(x1,y1); ctx.lineTo(x1+colW,y1); ctx.stroke();
        }
      }
    }
  }

  // 3) ê²½ë¡œ ê³„ì‚°
  function computePaths(){
    return all.map((_,i)=>{
      let cx=i, cy=0;
      const path = [{x:cx,y:cy}];
      while(cy<rows){
        if(cx<cols-1 && rungs[cy][cx]) cx++;
        else if(cx>0 && rungs[cy][cx-1]) cx--;
        cy++;
        path.push({x:cx,y:cy});
      }
      return path;
    });
  }

  // 4) ì• ë‹ˆë©”ì´ì…˜
  function animate(){
    drawLadder();
    const paths = computePaths();
    const speed = 50; // ms
    let pIndex=0;

    function animateOne(){
      const path = paths[pIndex];
      let step=0;
      const max = path.length;
      const color = all[pIndex].color;
      ctx.lineWidth=4; ctx.strokeStyle=color;
      const interval = setInterval(()=>{
        // ê·¸ë¦´ ì´ì „ê¹Œì§€ì˜ ë¼ì¸
        if(step>0){
          ctx.beginPath();
          const prev = path[step-1], curr = path[step];
          const x1=margin+prev.x*colW, y1=margin+prev.y*rowH;
          const x2=margin+curr.x*colW, y2=margin+curr.y*rowH;
          ctx.moveTo(x1,y1); ctx.lineTo(x2,y2); ctx.stroke();
        }
        step++;
        if(step>=max){
          clearInterval(interval);
          pIndex++;
          if(pIndex<paths.length){
            setTimeout(animateOne, 200);
          } else {
            showResults();
          }
        }
      }, speed);
    }
    animateOne();
  }

  // 5) ê²°ê³¼ í•˜ì´ë¼ì´íŠ¸
  function showResults(){
    const results = document.getElementById('results');
    results.innerHTML = '';
    // ë²Œì¹™ì
    const li0 = document.createElement('li');
    li0.className='punishment';
    li0.textContent = `ğŸ´ ${punishment.name} â†’ ${punishment.drink}`;
    results.appendChild(li0);
    // ë‹¹ì²¨ì: ìƒ· ì¶”ê°€ ìŒë£Œ ì°¾ê¸°
    const winner = all.find(p=>p.drink.includes('ìƒ·'));
    const li1 = document.createElement('li');
    li1.className='winner';
    li1.textContent = `ğŸ‰ ${winner.name} â†’ ${winner.drink}`;
    results.appendChild(li1);
    // ë‚˜ë¨¸ì§€
    all.forEach(p=>{
      if(p!==punishment && p!==winner){
        const li = document.createElement('li');
        li.textContent = `${p.name} â†’ ${p.drink}`;
        results.appendChild(li);
      }
    });
  }

  document.getElementById('startBtn').addEventListener('click', animate);
  // ìë™ ì‹¤í–‰
  animate();
  </script>
</body>
</html>
