<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì‚¬ë‹¤ë¦¬ê²Œì„ ì• ë‹ˆë©”ì´ì…˜</title>
  <style>
    body { margin:0; padding:1rem; font-family:sans-serif; background:#fafafa; text-align:center; }
    canvas { background:#fff; display:block; margin:0 auto; }
    button { margin-bottom:1rem; padding:.5rem 1rem; font-size:1rem; }
    #results { margin-top:1rem; list-style:none; padding:0; }
    #results li { margin:.5rem 0; }
    .punishment { color:#e74c3c; font-weight:bold; }
    .winner     { color:#27ae60; font-weight:bold; }
  </style>
</head>
<body>
  <h1>ğŸ¯ ì‚¬ë‹¤ë¦¬ê²Œì„</h1>
  <button id="startBtn">ì‚¬ë‹¤ë¦¬ íƒ€ê¸°</button>
  <canvas id="ladder"></canvas>
  <ul id="results"></ul>

  <script>
  // ì°¸ê°€ì+ë²Œì¹™ì+ìŒë£Œ+ì‚¬ì§„íŒŒì¼
  const participants = [
    {name:"Jinsoo",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"Jinsoo.png",        color:"#3498db"},
    {name:"ì„¸ë¯¸",          drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",       image:"ì„¸ë¯¸.png",          color:"#9b59b6"},
    {name:"êµ¬ìê±´",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"êµ¬ìê±´.png",        color:"#e67e22"},
    {name:"ê¹€ë§Œì„±",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ê¹€ë§Œì„±.png",        color:"#1abc9c"},
    {name:"ê¹€ì„¸ë´‰",        drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",       image:"ê¹€ì„¸ë´‰.png",        color:"#f1c40f"},
    {name:"ê¹€ì² ë™",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ê¹€ì² ë™.png",        color:"#e84393"},
    {name:"ê¹€íƒœí˜¸",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ê¹€íƒœí˜¸.png",        color:"#00cec9"},
    {name:"ì‹ ìœ ì„ ",        drink:"ì›í•˜ëŠ” ìŒë£Œ ì„ íƒ!!!",       image:"ì‹ ìœ ì„ .png",        color:"#0984e3"},
    {name:"ê°€ë³´ìê³ ~~",   drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ê°€ë³´ìê³ ~~.png",    color:"#d63031"},
    {name:"ì—„ê¸°ì¢…",        drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ì—„ê¸°ì¢….png",        color:"#6c5ce7"},
    {name:"ì´ì¬ìŠ¹",        drink:"ì•„ìƒ·ì¶” 2ì” with someone...", image:"ì´ì¬ìŠ¹.png",        color:"#00b894"},
    {name:"ì „ë•ì„±(ë² ë“œë¡œ)",drink:"ì•„ì´ìŠ¤ì•„ë©”ë¦¬ì¹´ë…¸",        image:"ì „ë•ì„±(ë² ë“œë¡œ).png", color:"#fdcb6e"}
  ];
  const punishment = {name:"ì„ìƒí˜", drink:"ì¶•~ë‹¹ì²¨: ë”¸ê¸°ìš”ê±°íŠ¸ìƒ·ì¶”ê°€", image:"ì„ìƒí˜.png", color:"#e74c3c"};
  
  const all = [punishment, ...participants];
  const cols = all.length, rows = 12;
  
  // ë ˆì´ì•„ì›ƒ ìƒìˆ˜
  const marginX = 50;
  const marginY = 20;
  const imgH = 40, nameH = 20;
  const colW = 100;
  const rowH = 30;
  const canvasWidth  = marginX*2 + colW*(cols-1);
  const canvasHeight = marginY + imgH + nameH + rowH*rows + marginY;
  
  // ìº”ë²„ìŠ¤ ì„¸íŒ…
  const canvas = document.getElementById('ladder');
  canvas.width  = canvasWidth;
  canvas.height = canvasHeight;
  const ctx = canvas.getContext('2d');
  
  // ì´ë¯¸ì§€ ë¡œë“œ
  const baseUrl = 'https://raw.githubusercontent.com/Devil-Destroyer/ladder/main/';
  let loaded = 0;
  const images = all.map(p => {
    const img = new Image();
    img.src = baseUrl + encodeURIComponent(p.image);
    img.onload = () => { if (++loaded === all.length) drawLadder(); };
    return img;
  });
  
  // ì‚¬ë‹¤ë¦¬ ê°€ë¡œì¤„ ìƒì„±
  const rungs = Array.from({length:rows}, () =>
    Array.from({length:cols-1}, () => Math.random() < 0.4)
  );
  
  // ì‚¬ë‹¤ë¦¬íŒ + ì‚¬ì§„ + ì´ë¦„ ê·¸ë¦¬ê¸°
  function drawLadder() {
    ctx.clearRect(0,0,canvasWidth,canvasHeight);
    // ì‚¬ì§„
    all.forEach((p,i) => {
      const x = marginX + i*colW - 20;
      ctx.drawImage(images[i], x, marginY, 40, imgH);
      ctx.fillStyle = "#333";
      ctx.textAlign = "center";
      ctx.font = "14px sans-serif";
      ctx.fillText(p.name, marginX + i*colW, marginY + imgH + nameH - 4);
    });
    // íšŒìƒ‰ì„  (ì„ íƒì ìœ¼ë¡œ ìˆ¨ê¸°ë ¤ë©´ ì£¼ì„ ì²˜ë¦¬)
    ctx.strokeStyle = "#ccc";
    ctx.lineWidth = 2;
    for(let i=0; i<cols; i++){
      const x = marginX + i*colW;
      ctx.beginPath();
      ctx.moveTo(x, marginY + imgH + nameH);
      ctx.lineTo(x, marginY + imgH + nameH + rowH*rows);
      ctx.stroke();
    }
    // ê°€ë¡œ ë§‰ëŒ€
    for(let y=0; y<rows; y++){
      for(let x=0; x<cols-1; x++){
        if(rungs[y][x]){
          const x1 = marginX + x*colW;
          const y1 = marginY + imgH + nameH + y*rowH;
          ctx.beginPath();
          ctx.moveTo(x1, y1);
          ctx.lineTo(x1+colW, y1);
          ctx.stroke();
        }
      }
    }
  }
  
  // ê²½ë¡œ ê³„ì‚° (90ë„ ì§€ê·¸ì¬ê·¸)
  function computePaths() {
    return all.map((_,idx) => {
      let cx = idx, cy = 0;
      const path = [{x:cx,y:cy}];
      for(let y=0; y<rows; y++){
        if(rungs[y][cx]){
          cx++; path.push({x:cx,y:y});
        } else if(cx>0 && rungs[y][cx-1]){
          cx--; path.push({x:cx,y:y});
        }
        path.push({x:cx,y:y+1});
      }
      return path;
    });
  }
  
  // ì• ë‹ˆë©”ì´ì…˜
  function animate() {
    drawLadder();
    const paths = computePaths();
    let i = 0;
    function next() {
      const path = paths[i];
      let step = 0;
      ctx.lineWidth = 4;
      ctx.strokeStyle = all[i].color;
      const timer = setInterval(() => {
        if(step > 0) {
          const p0 = path[step-1], p1 = path[step];
          const x0 = marginX + p0.x*colW;
          const y0 = marginY + imgH + nameH + p0.y*rowH;
          const x1 = marginX + p1.x*colW;
          const y1 = marginY + imgH + nameH + p1.y*rowH;
          ctx.beginPath();
          ctx.moveTo(x0,y0);
          ctx.lineTo(x1,y1);
          ctx.stroke();
        }
        step++;
        if(step >= path.length){
          clearInterval(timer);
          i++;
          if(i < paths.length){
            setTimeout(next, 200);
          } else {
            showResults();
          }
        }
      }, 100);
    }
    next();
  }
  
  // ê²°ê³¼ ì¶œë ¥
  function showResults() {
    const ul = document.getElementById('results');
    ul.innerHTML = '';
    // ë²Œì¹™ì
    const li0 = document.createElement('li');
    li0.className = 'punishment';
    li0.textContent = `ğŸ´ ${punishment.name} â†’ ${punishment.drink}`;
    ul.appendChild(li0);
    // ìƒ· ë‹¹ì²¨ì
    const winner = participants.find(p=>p.drink.includes('ìƒ·'));
    const li1 = document.createElement('li');
    li1.className = 'winner';
    li1.textContent = `ğŸ‰ ${winner.name} â†’ ${winner.drink}`;
    ul.appendChild(li1);
    // ë‚˜ë¨¸ì§€
    participants.forEach(p=>{
      if(p !== winner){
        const li = document.createElement('li');
        li.textContent = `${p.name} â†’ ${p.drink}`;
        ul.appendChild(li);
      }
    });
  }
  
  document.getElementById('startBtn').addEventListener('click', animate);
  // ìë™ ì‹œì‘
  // animate();
  </script>
</body>
</html>
